<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Voice Initiative</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="robots" content="noindex, nofollow">
    <!-- Make the app run in full-screen mode if saved to iOS home screen. -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="images/d20-black-whitebg.svg">
    <!-- <link rel="apple-touch-startup-image" href="path/to/startup-image.png"> -->
    <link rel="icon" type="image/svg" href="images/d20-black-whitebg.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
    href="https://fonts.googleapis.com/css2?family=Architects+Daughter&family=Babylonica&family=Bilbo+Swash+Caps&family=Caveat:wght@400;500;600;700&family=Comforter&family=Condiment&family=Dawning+of+a+New+Day&family=East+Sea+Dokdo&family=Fuggles&family=Grape+Nuts&family=Homemade+Apple&family=Inspiration&family=Julee&family=Just+Me+Again+Down+Here&family=Kolker+Brush&family=La+Belle+Aurore&family=Liu+Jian+Mao+Cao&family=Long+Can&family=Nanum+Brush+Script&family=Nothing+You+Could+Do&family=Oooh+Baby&family=Over+the+Rainbow&family=Permanent+Marker&family=Qwitcher+Grypen:wght@400;700&family=Reenie+Beanie&family=Rock+Salt&family=Ruthie&family=Sassy+Frass&family=Sedgwick+Ave&family=Shalimar&family=Smooch&family=Splash&family=Square+Peg&family=Swanky+and+Moo+Moo&family=Vujahday+Script&family=Waiting+for+the+Sunrise&family=Walter+Turncoat&family=Whisper&display=swap"
    rel="stylesheet">
    <script src="https://kit.fontawesome.com/d1a29cf881.js" crossorigin="anonymous"></script>
    <!-- Link to local CSS files -->
    <link rel="stylesheet" type="text/css" href="main.css">
    <link rel="stylesheet" type="text/css" href="./slideshow/slideshow.css">
    <link rel="stylesheet" type="text/css" href="./scripts/howlerDemo.css"/>

    <!-- Link to JavaScript files -->
    <script type="module" src="scripts/main.js"></script>
</head>

<body class="no-mic music"> <!-- Initially set to "no-mic", but may update via JS -->
    <div id="canvas-slideshow" class="canvas will-fade-in">
        <!-- To be populated via AJAX -->
    </div>
    <div id="canvas-initiative" class="canvas will-fade-in">

        <div class="header-menu">
            <div class="header-menu-left-side">
                <button id="settingsMenuOpenBtn" class="btn header-menu-btn  settings-menu-closed-ui">
                    <i class="fas fa-ellipsis"></i>
                </button>
                <button id="settingsMenuReturnBtn" class="btn header-menu-btn  settings-menu-open-ui">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <button id="refreshPageBtn" class="btn header-menu-btn  settings-menu-open-ui">
                    <i class="fas fa-refresh"></i>
                </button>
            </div>
            <div class="header-menu-right-side">
                <button id="musicBtn" class="btn header-menu-btn  play-music">
                    <i id="musicOn" class="fas fa-music"></i>
                    <i id="musicOff" class="fas fa-volume-xmark"></i>
                </button>
                <a id="sceneBtn" class="btn header-menu-btn  next-slide">
                    <i class="fas fa-image"></i>
                </a>
            </div>
        </div>

        <!-- Settings Menu -->
        <div class="settings-menu hide-right">
            <div class="settings-menu-inner">
                <h1 class="title">Voice Initiative<br/><sub><em>by orcnog</em></sub></h1>
                
                <div class="settings-menu-group toggle-full-screen-menu-group hide-in-ios">
                    <label class="settings-label" for="toggleFullScreenBtn">Full Screen
                        <i class="tooltip-icon fa-regular fa-circle-question"></i>
                        <p class="settings-label-tooltip-text expand-small">Enter full screen mode. Desktop only. Untested in Android.  Does not seem to work in iOS.</p>
                    </label>
                    <div class="settings-input">
                        <input id="toggleFullScreenBtn" type="checkbox" />
                    </div>
                </div>

                <div class="settings-menu-group">
                    <label class="settings-label" for="copyQueryStringToClipboard">Copy Initiative Link to Clipboard</label>
                    <div class="settings-input">
                        <button id="copyQueryStringToClipboard" class="btn btn-alt">
                            <i class="fas fa-link"></i>
                        </button>
                    </div>
                </div>
                <div class="settings-menu-group">
                    <label class="settings-label" for="pastedInitiativeUrl">Paste and Load Initiative URLFull Screen
                        <i class="tooltip-icon fa-regular fa-circle-question"></i>
                        <p class="settings-label-tooltip-text">Paste a copied initiative URL<br/>Ex: <code>d20.orcnog.com?round=1&turn=1&players=[{"name":"etc...</code>,<br/>Then, click the ↺ button to reload the app.</p>
                    </label>
                    <div class="settings-input">
                        <div class="button-group button-group">
                            <input id="pastedInitiativeUrl" class="input-text" type="text"/><button id="initiativeUrlPasteAndGo" class="btn btn-alt">↺</button>
                        </div>
                    </div>
                </div>
                <div class="settings-menu-group">
                    <label class="settings-label">Theme</label>
                    <div class="settings-input">
                        <select id="selectTheme"></select>
                    </div>
                </div>
                <div class="settings-menu-group">
                    <label class="settings-label">Combat Music</label>
                    <div class="settings-input">
                        <select id="selectCombatPlaylist"></select>
                    </div>
                </div>
                <div class="settings-menu-group">
                    <label class="settings-label" for="toggleUseOpenAI">Use OpenAI
                        <i class="tooltip-icon fa-regular fa-circle-question"></i>
                        <p class="settings-label-tooltip-text">Use OpenAI's Whisper AI model to transcribe your speech, instead of native browser Web Speech API. It's a bit slower, but it is usually far more accurate (especially on iOS). But hey, it <em>does</em> allow cuss words ;)</p>
                    </label>
                    <div class="settings-input">
                        <input id="toggleUseOpenAI" type="checkbox" />
                    </div>
                </div>
                <div class="settings-menu-group collapsible">
                    <label class="settings-label" for="toggleLiveText">Live Text
                        <i class="tooltip-icon fa-regular fa-circle-question"></i>
                        <p class="settings-label-tooltip-text expand-small">Available only when not using OpenAI transcription. Displays your speech as it is heard by the browser, in real time.</p>
                    </label>
                    <div class="settings-input">
                        <input id="toggleLiveText" type="checkbox" />
                    </div>
                </div>
                <div class="settings-menu-group collapsible">
                    <label class="settings-label" for="promptNames">Preferred name spellings
                        <i class="tooltip-icon fa-regular fa-circle-question"></i>
                        <p class="settings-label-tooltip-text">Enter custom spellings for player or creature names to train OpenAI to hear and transcribe them correctly. Names should be separated by commas.<br/></p>
                    </label>
                    <div class="settings-input">
                        <div class="button-group button-group">
                            <textarea id="promptNames" class="white-space-pre"></textarea>
                        </div>
                    </div>
                </div>
                <div class="settings-menu-group">
                    <label class="settings-label" for="appScalePref">App Scale
                    <i class="tooltip-icon fa-regular fa-circle-question"></i>
                    <p class="settings-label-tooltip-text expand-small">Zoom level for the entire app (button sizes, font sizes, everything). Useful if you are projecting to a screen that is too large or too small for the default app dimensions.</p>
                </label>
                    <div class="settings-input">
                        <div class="button-group button-group-number-bump">
                            <button id="decrAppScale" class="btn">-</button>
                            <input id="appScalePref" class="input-number-bump" value="2" type="number" />
                            <button id="incrAppScale" class="btn">+</button>
                        </div>
                    </div>
                </div>
                <div class="settings-menu-group">
                    <label class="settings-label" for="brightnessPref">Brightness</label>
                    <div class="settings-input">
                        <div class="button-group button-group-number-bump">
                            <button id="decrBrightness" class="btn">-</button>
                            <input id="brightnessPref" class="input-number-bump" value="1" type="number" />
                            <button id="incrBrightness" class="btn">+</button>
                        </div>
                    </div>
                </div>
                <div class="settings-menu-group">
                    <label class="settings-label" for="fontSizePref">Font Size</label>
                    <div class="settings-input">
                        <div class="button-group button-group-number-bump">
                            <button id="decrFontSize" class="btn">-</button>
                            <input id="fontSizePref" class="input-number-bump" value="1" type="number" />
                            <button id="incrFontSize" class="btn">+</button>
                        </div>
                    </div>
                </div>
                <p class="lorem-ipsum">Lorem Ipsum</p>
                <!--
                <div class="settings-menu-group">
                    <label class="settings-label" for="selectFont">Font</label>
                    <div class="settings-input">
                        <select id="selectFont"></select>
                    </div>
                </div>
                <div class="settings-menu-group">
                    <label class="settings-label" for="toggleFontAllCaps">Font all caps</label>
                    <div class="settings-input">
                        <input id="toggleFontAllCaps" type="checkbox" />
                    </div>
                </div>
                -->
                <div class="settings-menu-group">
                    <label class="settings-label" for="chalkinessPref">Chalkiness Adjust
                        <i class="tooltip-icon fa-regular fa-circle-question"></i>
                        <p class="settings-label-tooltip-text expand-small">Adjust the level of distress effect (or "chalkiness", since it is meant to look like chalk on slate) of the app's text.</p>
                    </label>
                    <div class="settings-input">
                        <div class="button-group button-group-number-bump">
                            <button id="decrChalkiness" class="btn">-</button>
                            <input id="chalkinessPref" class="input-number-bump" value="0.75" type="number" />
                            <button id="incrChalkiness" class="btn">+</button>
                        </div>
                    </div>
                </div>
                <div class="settings-menu-group">
                    <label class="settings-label" for="openMusicMenu">Music Player</label>
                    <div class="settings-input">
                        <button id="openMusicMenu" class="btn"><i class="fas fas fa-ellipsis"></i></button>
                    </div>
                </div>
                <div class="settings-menu-group">
                    <label class="settings-label" for="openSlideshowMenu">Slideshow Configuration</label>
                    <div class="settings-input">
                        <button id="openSlideshowMenu" class="btn"><i class="fas fas fa-ellipsis"></i></button>
                    </div>
                </div>
                <div class="settings-menu-group event-log">
                    <label class="settings-label">Console Log</label>
                    <p id="eventlog"></p>
                </div>
            </div>
        </div>

        <!-- Music -Slide Out Menu -->
        <div id="musicMenu" class="settings-sub-menu hide-right">
            <div class="settings-menu-inner">
                <h2 class="title">Audio Player</h2>

                <div class="settings-menu-group">
                    <label class="settings-label">Playlists</label>
                    <div class="settings-input">
                        <select id="selectMusicPlayerPlaylist"></select>
                    </div>
                </div>
                <div id="musicPlayer" class="howlerPlayer">
                    <!-- Top Info -->
                    <div class="title">
                    <div class="timer">0:00</div>
                    <span class="track"></span>
                    <div class="duration">0:00</div>
                    </div>
                    <!-- Controls -->
                    <div class="controlsOuter">
                        <div class="btn playlistBtn"></div>
                        <div class="btn loopBtn"><i class="fa fa-rotate"></i></div>
                        <div class="controlsInner">
                            <div class="loading"></div>
                            <div class="btn prevBtn"></div>
                            <div class="btn playBtn"></div>
                            <div class="btn pauseBtn"></div>
                            <div class="btn nextBtn"></div>
                        </div>
                        <div class="btn shuffleBtn"><i class="fa fa-shuffle"></i></div>
                        <div class="btn volumeBtn"></div>
                    </div>
                    <!-- Progress -->
                    <div class="waveform"></div>
                    <div class="bar"></div>
                    <div class="progress"></div>
                    <!-- Playlist -->
                    <div class="playlistmenu">
                    <div class="list"></div>
                    </div>
                    <!-- Volume -->
                    <div class="volumeOverlay fadeout">
                    <input class="volumeSlider" type="range" min="1" max="100" value="100">
                    </div>
                    <!-- Scripts -->
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
                </div>
            </div>
        </div>

        <!-- Slideshow Configurator Menu -->
        <div id="slideshowMenu" class="settings-sub-menu hide-right">
            <div class="settings-menu-inner">
                <h2 class="title">Slideshow Configurator</h2>
                
                <div class="settings-menu-group">
                    <label class="settings-label">Slideshow</label>
                    <div class="settings-input">
                        <select id="selectSlideshow">
                            <option value="">None</option>
                        </select>
                    </div>
                </div>
                <div class="settings-menu-group hidden-if-previous-group-not-active">
                    <label class="settings-label">Next Slide to Show</label>
                    <div class="settings-input">
                        <select id="slideshowNextSlide">
                        </select>
                    </div>
                </div>
                <div class="settings-menu-group settings-menu-grow">
                    <label class="settings-label">Homebrew Slideshow Configuration
                        <i class="tooltip-icon fa-regular fa-circle-question"></i>
                        <p class="settings-label-tooltip-text expand-large">You can define a slideshow of custom images, which can be shown while in the app. You'll have to be at least 1% confortable with JSON format (see the example). The slideshow configuration can handle image urls, captions for each image, and subcaptions below those. Anything more than that is beyond the scope of this feature. The easiest way to create a slideshow of custom images would be to upload them to a gallery site like imgur, copy each image's URL, making sure to grab the URL to the direct image file, e.g. a URL ending in ".jpg", ".webp" or ".png" (tip: in imgur, click the "Copy Link" button, then when you paste the link, just manually add ".jpg" to the end), and then replace the values in the sample JSON, along with updating the caption/subcap values.<br/><br/>Allowable values for exoticfont are: 'Aurebesh', 'Elvish', or 'Dwarvish'.<br/><br/>If you erased or saved over the sample JSON and want to see it again, completely erase all JSON from the textarea below and refresh the page.</p>
                    </label>
                    <div class="settings-input">
                        <textarea id="homebrewSlideshowJSON" class="white-space-pre">{
  "awesome-homebrew-slideshow": {
    "name": "My Rad Slideshow",
    "exoticfont": "Elvish",
    "scenes": [
      {
        "image": "https://i.pinimg.com/736x/ea/9d/2f/ea9d2fcc94de453d03a3a488c9d7fde3.jpg",
        "caption": "The Celestial Citadel",
        "subcap": "Somewhere near the Spine of the World"
      },
      {
        "image": "https://static1.thegamerimages.com/wordpress/wp-content/uploads/2024/03/the-gamer-cover-images-22.jpg",
        "caption": "The Lionshield Coster",
        "subcap": "Phandalin, Sword Coast"
      }
    ]
  }
}</textarea>
                        <button id="homebrewSlideshowSave" class="btn btn-alt">Save to cookie</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Experimental / debugging utility... hidden -->
        <p class="interim-output" id="interimOutput"><span id="finalTranscript"></span> <span id="interimTranscript"></span></p>

        <div class="main">
            <button id="clearAll" class="clear-all btn btn-clear players-listed-ui">✕</button>
            <form action="#" style="display:none;"><input id="testInput" type="text" placeholder="test input" /></form>
            <!--<div id="startDictation" class="gn" tabindex="0"><div class="mc"></div></div>-->
            <div class="pre-mic microphone-msg">
                <p>Tap the mic to enable microphone on your device</p>
            </div>
            <div class="post-mic microphone-msg">
                <p>Tap the mic button to turn the mic on. Speak initiative rolls. Ex: "Grog 17, Scanlan 12"</p>
            </div>
            <div class="denied-mic microphone-msg">
                <p>Microphone access denied. Please REFRESH the page or use manual entry.</p>
            </div>
                
            <div class="players">
                <div id="roundCounter" class="round-counter">
                    <span class="round-label">Round&nbsp;</span>
                    <!-- will be populated dynamically with: <div class="round-tally" data-marks="0"></div> -->
                </div>
                <div class="prev-next-btns">
                    <button id="prevTurn" class="previous-turn btn btn-clear active-turn-ui"><i
                        class="fas fa-chevron-left" aria-hidden="true"></i></button>
                    <button id="nextTurn" class="advance-turn btn btn-clear  active-turn-ui"><i
                        class="fas fa-chevron-right" aria-hidden="true"></i></button>
                    
                </div>
                <ul id="entries">
                    <!-- will be populated dynamically -->
                </ul>
                <button id="addPlayer" class="add-a-player btn btn-clear">+</button>
            </div>
            <div class="button-group">
                <div id="startDictation">
                    <i class="fa-solid fa-microphone"></i>
                </div>
            </div>
            <!-- <button id="startButton" class="btn no-active-turn-ui players-listed-ui">Start</button> -->
            <form id="speechForm" class="" action="">
                <input id="speechInput" class="speech-input" type="text"
                data-focused-placeholder="⇣ Dictate with voice key, then press ↵" placeholder="Ex: Grog 13, Pike 7" />
            </form>
        </div>
    </div>
</body>
</html>